(()=>{"use strict";const l=()=>{const l={1:[null,null,null,null,null,null,null,null,null,null],2:[null,null,null,null,null,null,null,null,null,null],3:[null,null,null,null,null,null,null,null,null,null],4:[null,null,null,null,null,null,null,null,null,null],5:[null,null,null,null,null,null,null,null,null,null],6:[null,null,null,null,null,null,null,null,null,null],7:[null,null,null,null,null,null,null,null,null,null],8:[null,null,null,null,null,null,null,null,null,null],9:[null,null,null,null,null,null,null,null,null,null],10:[null,null,null,null,null,null,null,null,null,null]},e=[];return{board:l,placeShip:(t,n,u)=>{const r=n[0],o=n[1],a=u[0],s=u[1];if(r===a){let n=0;for(let e=o;e<=s;e++)l[e][r]=[t,n],n++;e.push(t)}else{let n=0;for(let e=r;e<=a;e++)l[o][e]=[t,n],n++;e.push(t)}return l},receiveAttack:(e,t)=>{if(l[t][e]){let n=l[t][e][0],u=l[t][e][1];return"miss"===l[t][e]||!0===n.hitStatus[u]?"already guessed":(n.hit(u),"hit")}return l[t][e]="miss","miss"},allShipsSunk:()=>e.map((l=>l.isSunk())).every((l=>!0===l)),randomlyPlaceShips:(l,e)=>{l.forEach((l=>{const t=Math.floor(2*Math.random());let n,u;const r=()=>{if(0===t){n=Math.floor(6*Math.random()),u=Math.floor(10*Math.random())+1;for(let t=0;t<l.length;t++)e.board[u][n+t]&&r()}else{n=Math.floor(9*Math.random()),u=Math.floor(6*Math.random())+1;for(let t=0;t<l.length;t++)e.board[u+t][n]&&r()}return[n,u]},o=r();0===t?e.placeShip(l,o,[o[0]+l.length-1,o[1]]):e.placeShip(l,o,[o[0],o[1]+l.length-1])}))}}},e=(l,e,t,n,u,r)=>{const o=Object.keys(e.board),a=document.querySelector(".player-board");var s,c;a.textContent="Place your ships",s=e.board,c=a,o.map((l=>{let e=document.createElement("div");e.classList.add("row"),c.appendChild(e),s[l].map(((t,n)=>{let u=document.createElement("div");u.classList.add("space"),u.setAttribute("data-coord",`${n},${l}`),c===a&&t&&(u.style.background="grey"),e.appendChild(u)}))}));const d=document.querySelector(".computer-board"),i=document.createElement("button");i.textContent="orientation",d.appendChild(i),i.addEventListener("click",(()=>{b="x"===b?"y":"x"}));const m=(l,t,n)=>{const u=l[0],r=l[1];if(t[0],t[1],"x"===b){for(let l=0;l<n;l++)if(e.board[r][Number(u)+l])return!1;return!0}for(let l=0;l<n;l++)if(e.board[Number(r)+l][u])return!1;return!0};let p=n.shift(),h=p.length,b="x";a.addEventListener("click",(o=>{if("space"!==o.target.classList[0])return;const s=o.target.dataset.coord.split(",");if("x"===b){if(!document.querySelector(`[data-coord="${Number(s[0])+h-1},${s[1]}"]`)||!m(s,[Number(s[0])+h-1,s[1]],h))return;e.placeShip(p,s,[Number(s[0])+h-1,s[1]])}else{if(!document.querySelector(`[data-coord="${s[0]},${Number(s[1])+h-1}"]`)||!m(s,[s[0],Number(s[1])+h-1],h))return;e.placeShip(p,s,[s[0],Number(s[1])+h-1])}p=n.shift(),p?h=p.length:(h=0,a.replaceWith(a.cloneNode(!0)),((l,e,t,n,u)=>{const r=(l,e)=>{o.map((t=>{let n=document.createElement("div");n.classList.add("row"),e.appendChild(n),l[t].map(((l,u)=>{let r=document.createElement("div");r.classList.add("space"),r.setAttribute("data-coord",`${u},${t}`),e===a&&l&&(r.style.background="grey"),n.appendChild(r)}))}))},o=Object.keys(e.board),a=document.querySelector(".player-board");a.textContent=`${t.name}'s Board`,r(e.board,a),a.classList.add("disable-clicks");const s=document.querySelector(".computer-board");s.textContent="Computers Board",r(l.board,s);const c=(l,e)=>{if("space"===e.target.classList[0]){const t=e.target.dataset.coord.split(",");let n=Number(t[0]),u=Number(t[1]);const r=l.receiveAttack(n,u);if(e.target.classList.add("disable-clicks"),"hit"===r){const l=document.createElement("div");l.classList.add("hit"),e.target.appendChild(l)}else"miss"===r&&(e.target.style="background: blue");return r}};s.addEventListener("click",(e=>{const t=c(l,e),r=n().split(",");let o=a.querySelector(`[data-coord='${r[0]},${r[1]}']`);t&&!u()&&setTimeout((()=>o.click()),500)})),a.addEventListener("click",(l=>{c(e,l)}))})(l,e,t,u,r))}));const y=l=>{const e=l.target.dataset.coord.split(",");let t=[];if("y"===b)for(let l=0;l<h;l++){const n=document.querySelector(`[data-coord="${e[0]},${Number(e[1])+l}"]`);n&&t.push(n)}else for(let l=0;l<h;l++){const n=document.querySelector(`[data-coord="${Number(e[0])+l},${e[1]}"]`);n&&t.push(n)}t.forEach((l=>{l.style.background="red"}))},f=l=>{const e=l.target.dataset.coord.split(",");let t=[];if("y"===b)for(let l=0;l<h;l++){const n=document.querySelector(`[data-coord="${e[0]},${Number(e[1])+l}"]`);n&&t.push(n)}else for(let l=0;l<h;l++){const n=document.querySelector(`[data-coord="${Number(e[0])+l},${e[1]}"]`);n&&t.push(n)}t.forEach((l=>{l.removeAttribute("style")}))};document.querySelectorAll(".space").forEach((l=>{l.addEventListener("mouseenter",y),l.addEventListener("mouseleave",f)}))},t=l=>{const e=Array(l).fill(!1);return{length:l,hitStatus:e,isSunk:()=>e.every((l=>!0===l)),hit:l=>{e[l]=!0}}},n=l=>{const e=[],t=()=>{const l=Math.floor(9*Math.random()),n=Math.floor(10*Math.random())+1;let u=[l,n];return e.includes(`${l},${n}`)&&(u=t()),e.push(`${u[0]},${u[1]}`),u};return{name:l,playedMoves:e,computerPlay:t}};(()=>{const u=n("x"),r=l(),o=[t(5),t(4),t(3),t(3),t(2)],a=n("Computer"),s=l(),c=[t(5),t(4),t(3),t(3),t(2)];s.randomlyPlaceShips(c,s),e(s,r,u,o,(()=>{s.allShipsSunk()?(alert("Player wins"),document.querySelector(".computer-board").classList.add("disable-clicks")):r.allShipsSunk()&&(alert("Computer wins"),document.querySelector(".computer-board").classList.add("disable-clicks"));const l=a.computerPlay();return`${l[0]},${l[1]}`}),(()=>s.allShipsSunk()||r.allShipsSunk()))})()})();